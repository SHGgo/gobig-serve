(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ee949a4e"],{"23e7":function(e,t,r){},3260:function(e,t,r){},"32a2":function(e,t,r){"use strict";var n=r("5f89"),o=r.n(n);o.a},"3da8":function(e,t,r){},"5f89":function(e,t,r){},"5fc7":function(e,t,r){"use strict";var n=r("d4d7"),o=r.n(n);o.a},6747:function(e,t,r){"use strict";var n=r("3260"),o=r.n(n);o.a},"8eb4":function(e,t,r){"use strict";var n=r("23e7"),o=r.n(n);o.a},d4d7:function(e,t,r){},e066:function(e,t,r){"use strict";var n=r("3da8"),o=r.n(n);o.a},ee55:function(e,t,r){"use strict";r.r(t);var n,o,i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("search-bar"),e._v(" "),r("button-bar",{staticClass:"button-bar"}),e._v(" "),r("show-table"),e._v(" "),r("insert-and-edit-user-info",{attrs:{"dialog-info-visible":e.dialogInfoVisible},on:{"update:dialogInfoVisible":function(t){e.dialogInfoVisible=t},"update:dialog-info-visible":function(t){e.dialogInfoVisible=t}}})],1)},a=[],s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"button-bar-container"},[r("el-row",[r("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.insertUser}},[e._v("添加用户")])],1)],1)},l=[],u={data:function(){return{dialogInfoVisible:!1}},methods:{insertUser:function(){this.$store.commit("userManage/SET_DIALOG",!0)}}},c=u,f=(r("6747"),r("2877")),m=Object(f["a"])(c,s,l,!1,null,"69631ca9",null),d=m.exports,p=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"search-bar-container"},[r("el-form",{ref:"searchForm",staticClass:"demo-form-inline",attrs:{inline:!0,model:e.searchForm,rules:e.rules}},[r("el-form-item",{ref:"condition",attrs:{label:"查询条件:",prop:"condition"}},[r("el-select",{attrs:{placeholder:"查询条件"},model:{value:e.searchForm.condition,callback:function(t){e.$set(e.searchForm,"condition",t)},expression:"searchForm.condition"}},[r("el-option",{attrs:{label:"uid",value:"uid"}}),e._v(" "),r("el-option",{attrs:{label:"昵称",value:"nickName"}})],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"查询内容:",prop:"keyWord"}},[r("el-input",{attrs:{placeholder:"请输入..."},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.searchForm.keyWord,callback:function(t){e.$set(e.searchForm,"keyWord",t)},expression:"searchForm.keyWord"}})],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:e.search}},[e._v("查询")])],1)],1)],1)},g=[],h=(r("04ff"),r("c5f6"),r("7cdf"),{data:function(){var e=this,t=function(t,r,n){if(r||n(),"uid"===e.searchForm.condition){if(!Number.isInteger(Number.parseInt(r)))return void n(new Error("请输入数字"))}else if("nickName"===e.searchForm.condition&&!/^[\u4E00-\u9FA5a-zA-Z0-9_-]{1,10}$/.test(r))return void n(new Error("最多10位汉字、数字、字母等字符"));n()};return{searchForm:{keyWord:"",condition:""},rules:{condition:[{required:!0,message:"请选择查询条件",trigger:"blur"}],keyWord:[{trigger:"change",validator:t}]}}},computed:{watchKeyWord:function(){return this.searchForm.keyWord},watchCondition:function(){return this.searchForm.condition}},watch:{watchKeyWord:function(){this.$store.commit("userManage/SET_KEYWORD",this.searchForm.keyWord),this.$store.commit("userManage/SET_CONDITION",this.searchForm.condition)},watchCondition:function(){this.$store.commit("videoManage/SET_KEYWORD",this.searchForm.keyWord),this.$store.commit("videoManage/SET_CONDITION",this.searchForm.condition)}},methods:{search:function(){var e=this;this.$refs.searchForm.validate((function(t){if(!t)return!1;e.$store.dispatch("userManage/search",{}).then((function(){e.$message({message:"查询成功",type:"success",duration:3e3})})).catch((function(t){e.$message({message:t,type:"error",duration:3e3})}))}))}}}),b=h,v=(r("5fc7"),Object(f["a"])(b,p,g,!1,null,"041d8228",null)),F=v.exports,I={},_=Object(f["a"])(I,n,o,!1,null,null,null),w=(_.exports,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"show-table-container"},[r("el-table",{ref:"showTbale",staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",stripe:"","empty-text":""}},[r("el-table-column",{attrs:{type:"index",align:"center",width:"50",label:"序列"}}),e._v(" "),r("el-table-column",{attrs:{property:"uid",align:"center",label:"uid",width:"100"}}),e._v(" "),r("el-table-column",{attrs:{property:"figure",align:"center",label:"头像",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-image",{staticClass:"figure border-radius-circle",attrs:{src:t.row.figure,"preview-src-list":[t.row.figure],lazy:""}},[r("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[r("i",{staticClass:"el-icon-picture-outline"})]),e._v(" "),r("div",{staticClass:"image-slot",attrs:{slot:"placeholder"},slot:"placeholder"},[r("i",{staticClass:"el-icon-loading"})])])]}}])}),e._v(" "),r("el-table-column",{attrs:{property:"nickName",align:"left",label:"昵称",width:"150"}}),e._v(" "),r("el-table-column",{attrs:{property:"gender",align:"center",label:"性别",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(e.genderFix(t.row.gender))+"\n      ")]}}])}),e._v(" "),r("el-table-column",{attrs:{property:"signature",align:"left",label:"签名",width:"400"}}),e._v(" "),r("el-table-column",{attrs:{property:"birthDate",align:"center",label:"生日",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(e._f("parseTime")(t.row.birthDate,"{y}-{m}-{d}"))+"\n      ")]}}])}),e._v(" "),r("el-table-column",{attrs:{property:"attentionCount",align:"center",label:"关注数",width:"100"}}),e._v(" "),r("el-table-column",{attrs:{property:"fanCount",align:"center",label:"粉丝数",width:"100"}}),e._v(" "),r("el-table-column",{attrs:{property:"likeCount",align:"center",label:"点赞数",width:"100"}}),e._v(" "),r("el-table-column",{attrs:{property:"viewCount",align:"center",label:"播放数",width:"100"}}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:"Actions","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary",size:"small",disabled:e.loading},on:{click:function(r){return e.editUser(t.row)}}},[e._v("编辑")]),e._v(" "),r("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(r){return e.deleteUserWarning(t,e.tableData)}}},[e._v("删除")])]}}])})],1),e._v(" "),r("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.listQuery.page,limit:e.listQuery.limit},on:{"update:page":function(t){return e.$set(e.listQuery,"page",t)},"update:limit":function(t){return e.$set(e.listQuery,"limit",t)},pagination:e.pageSearch}})],1)}),y=[],k=r("ed08"),$=r("333d"),C={filters:{parseTime:k["a"]},components:{Pagination:$["a"]},data:function(){return{tableData:[],total:0,listLoading:!0,listQuery:{page:1,limit:10},dialogInfoVisible:!1,loading:!1}},computed:{watchShowTbale:function(){return this.$store.state.userManage.showTable},genderFix:function(e){return function(e){return 1===Number.parseInt(e)?"男":"女"}}},watch:{watchShowTbale:function(e){this.tableData=e.table,this.total=e.total}},created:function(){this.pageSearch()},methods:{pageSearch:function(){var e=this;this.listLoading=!0;var t=(this.listQuery.page-1)*this.listQuery.limit;this.$store.dispatch("userManage/search",{pageStart:t,pageItemNum:this.listQuery.limit}).then((function(t){e.total=t.total})).catch((function(t){e.$message({message:t,type:"error",duration:6e3})}))},editUser:function(e){this.$store.commit("userManage/SET_USERINFO",e),this.$store.commit("userManage/SET_DIALOG",!0)},deleteUser:function(e,t){var r=this,n={uid:e.row.uid};this.$store.dispatch("userManage/delete",n).then((function(){t.splice(e.$index,1),r.$message({type:"success",message:"删除成功!"})})).catch((function(e){var t=40301===e?"请向删除完用户其他信息，如视频等":"未知错误，请重新删除";r.$alert(t,"删除失败",{confirmButtonText:"确定"})}))},deleteUserWarning:function(e,t){var r=this;this.$confirm("此操作将永久删除用户, 是否继续?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){r.deleteUser(e,t)})).catch((function(){r.$message({type:"info",message:"已取消删除"})}))}}},x=C,S=(r("e066"),Object(f["a"])(x,w,y,!1,null,"77a8b046",null)),D=S.exports,T=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"dialog-Info-container"},[r("el-dialog",{attrs:{title:e.userInfo?"更新用户":"添加用户",visible:e.crruentVisible,center:""},on:{"update:visible":function(t){e.crruentVisible=t},close:e.closeDialog}},[r("el-form",{ref:"userInfoForm",attrs:{rules:e.rules,"label-width":"80px",model:e.userInfoForm}},[e.userInfo?e._e():r("el-row",[r("el-col",{attrs:{span:6}},[r("el-form-item",{attrs:{prop:"userAccount",label:"用户账号"}},[r("el-input",{staticStyle:{width:"220px"},model:{value:e.userInfoForm.userAccount,callback:function(t){e.$set(e.userInfoForm,"userAccount",t)},expression:"userInfoForm.userAccount"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:6,offset:3}},[r("el-form-item",{attrs:{prop:"pwd",label:"用户密码"}},[r("el-input",{staticStyle:{width:"220px"},attrs:{type:"password",autocomplete:"off"},model:{value:e.userInfoForm.pwd,callback:function(t){e.$set(e.userInfoForm,"pwd",t)},expression:"userInfoForm.pwd"}})],1)],1)],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:6}},[r("el-form-item",{attrs:{prop:"nickName",label:"昵称"}},[r("el-input",{staticStyle:{width:"220px"},model:{value:e.userInfoForm.nickName,callback:function(t){e.$set(e.userInfoForm,"nickName",t)},expression:"userInfoForm.nickName"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:6,offset:3}},[r("el-form-item",{attrs:{prop:"gender",label:"性别"}},[r("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"请选择"},model:{value:e.userInfoForm.gender,callback:function(t){e.$set(e.userInfoForm,"gender",t)},expression:"userInfoForm.gender"}},[r("el-option",{key:"1",attrs:{label:"男",value:"1"}}),e._v(" "),r("el-option",{key:"0",attrs:{label:"女",value:"0"}})],1)],1)],1)],1),e._v(" "),r("el-form-item",{attrs:{prop:"signature",label:"签名"}},[r("el-input",{model:{value:e.userInfoForm.signature,callback:function(t){e.$set(e.userInfoForm,"signature",t)},expression:"userInfoForm.signature"}})],1),e._v(" "),r("el-form-item",{attrs:{prop:"figure",label:"头像"}},[r("el-upload",{staticClass:"avatar-uploader",attrs:{action:"#","show-file-list":!1,limit:1,accept:"image/png, image/jpeg, image/jpg","before-upload":e.checkAndPreviewImg}},[e.userInfoForm.figure?r("img",{staticClass:"avatar",attrs:{src:e.userInfoForm.figure}}):r("i",{staticClass:"el-icon-plus avatar-uploader-icon"}),e._v(" "),r("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("支持jpg,png等格式,5mb以下大小的图片")])])],1),e._v(" "),r("el-form-item",{attrs:{prop:"birthDate",label:"生日"}},[r("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:e.userInfoForm.birthDate,callback:function(t){e.$set(e.userInfoForm,"birthDate",t)},expression:"userInfoForm.birthDate"}})],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:6}},[r("el-form-item",{attrs:{prop:"attentionCount",label:"关注数"}},[r("el-input",{attrs:{type:"number",min:"0",max:"99999999"},model:{value:e.userInfoForm.attentionCount,callback:function(t){e.$set(e.userInfoForm,"attentionCount",e._n(t))},expression:"userInfoForm.attentionCount"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:6}},[r("el-form-item",{attrs:{prop:"fanCount",label:"粉丝数"}},[r("el-input",{attrs:{type:"number",min:"0",max:"99999999"},model:{value:e.userInfoForm.fanCount,callback:function(t){e.$set(e.userInfoForm,"fanCount",e._n(t))},expression:"userInfoForm.fanCount"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:6}},[r("el-form-item",{attrs:{prop:"likeCount",label:"点赞数"}},[r("el-input",{attrs:{type:"number",min:"0",max:"99999999"},model:{value:e.userInfoForm.likeCount,callback:function(t){e.$set(e.userInfoForm,"likeCount",e._n(t))},expression:"userInfoForm.likeCount"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:6}},[r("el-form-item",{attrs:{prop:"viewCount",label:"播放数"}},[r("el-input",{attrs:{type:"number",min:"0",max:"99999999"},model:{value:e.userInfoForm.viewCount,callback:function(t){e.$set(e.userInfoForm,"viewCount",e._n(t))},expression:"userInfoForm.viewCount"}})],1)],1)],1),e._v(" "),r("el-form-item",{staticStyle:{"margin-top":"30px"}},[r("el-button",{attrs:{type:"primary",icon:e.loading?"el-icon-loading":"el-icon-upload",disabled:e.loading},on:{click:function(t){return e.submitForm("userInfoForm")}}},[e._v(e._s(e.userInfo?"立即更新":"立即添加"))]),e._v(" "),r("el-button",{staticStyle:{"margin-left":"50px"},on:{click:function(t){return e.resetForm("userInfoForm")}}},[e._v("重置")])],1)],1)],1)],1)},E=[],N={props:{dialogInfoVisible:{type:Boolean,default:!1}},data:function(){var e=function(e,t,r){/^[0-9a-zA-Z_]{3,15}$/.test(t)||r("3-15位数字、字母、下划线等字符"),r()},t=function(e,t,r){/^[0-9a-zA-Z]{3,15}$/.test(t)||r("3-15位数字、字母等字符"),r()};return{loading:!1,figureFile:null,defaultUserInfoForm:{userAccount:"",pwd:"",nickName:"",gender:null,signature:"",figure:null,birthDate:0,attentionCount:0,fanCount:0,likeCount:0,viewCount:0},userInfoForm:null,rules:{userAccount:[{required:!0,message:"请输入用户账号",trigger:"blur"},{trigger:"blur",validator:e}],pwd:[{required:!0,message:"请输入用户密码",trigger:"blur"},{trigger:"blur",validator:t}],nickName:[{required:!0,message:"请输入用户昵称",trigger:"blur"},{min:1,max:10,message:"长度在 1 到 10 个字符",trigger:"blur"}],gender:[{required:!0,message:"请选择用户性别",trigger:"blur"}],signature:[{required:!0,message:"请输入用户签名",trigger:"blur"},{min:1,max:50,message:"长度在 1 到 50 个字符",trigger:"change"}],birthDate:[{required:!0,message:"请选择用户生日",trigger:"blur"},{type:"date",required:!0,message:"请选择日期",trigger:"blur"}],figure:[{required:!0,message:"请选择用户头像",trigger:"blur"}]}}},computed:{crruentVisible:{get:function(){return this.dialogInfoVisible},set:function(e){this.$emit("update:dialogInfoVisible",e)}},userInfo:{get:function(){return this.$store.state.userManage.userInfo}}},watch:{userInfo:function(e){this.userInfoForm=Object.assign({},e)||this.defaultUserInfoForm}},created:function(){this.userInfoForm=this.defaultUserInfoForm},methods:{checkAndPreviewImg:function(e){var t=/image\/[jpeg|png|jpg]/.test(e.type),r=e.size/1024/1024<2;return t||this.$message.error("图片格式错误!"),r||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&r&&(this.userInfoForm.figure=URL.createObjectURL(e),this.figureFile=e),!1},submitForm:function(e){var t=this;this.loading=!0,this.$refs[e].validate((function(e){if(!e)return!1;var r=new FormData;if(t.figureFile?r.set("file",t.figureFile):r=null,t.userInfo)t.editUser(t.userInfoForm,r);else{var n=t.insertJsonFix();t.insertUser(n,r)}}))},editUser:function(e,t){var r=this;this.$store.dispatch("userManage/update",{json:e,formData:t}).then((function(){Object.assign(r.userInfo,r.userInfoForm),r.$message({message:"更新用户成功",type:"success"}),r.loading=!1})).catch((function(e){console.log(e);var t=r.errorFix(e);r.$alert(t,"更新失败",{confirmButtonText:"确定"}),r.loading=!1}))},insertUser:function(e,t){var r=this;this.$store.dispatch("userManage/insert",{json:e,formData:t}).then((function(){r.$message({message:"添加用户成功",type:"success"}),r.loading=!1})).catch((function(e){console.log(e);var t=r.errorFix(e);r.$alert(t,"添加失败",{confirmButtonText:"确定"}),r.loading=!1}))},resetForm:function(e){this.$refs[e].resetFields()},closeDialog:function(){this.$store.commit("userManage/SET_USERINFO",null)},changeTableUserInfo:function(){},insertJsonFix:function(){var e={userAccount:this.userInfoForm.userAccount,pwd:this.userInfoForm.pwd},t={nickName:this.userInfoForm.nickName,gender:this.userInfoForm.gender,signature:this.userInfoForm.signature,figure:this.userInfoForm.figure,birthDate:this.userInfoForm.birthDate,attentionCount:this.userInfoForm.attentionCount,fanCount:this.userInfoForm.fanCount,likeCount:this.userInfoForm.likeCount,viewCount:this.userInfoForm.viewCount};return{user:e,userContent:t}},errorFix:function(e){var t="";switch(e){case 40301:t="用户账号重复，请更换用户账号";break;default:t="未知原因，请重新操作"}return t}}},O=N,U=(r("32a2"),Object(f["a"])(O,T,E,!1,null,null,null)),A=U.exports,M={components:{SearchBar:F,ButtonBar:d,ShowTable:D,InsertAndEditUserInfo:A},data:function(){return{}},computed:{dialogInfoVisible:{get:function(){return this.$store.state.userManage.dialogInfoVisible},set:function(e){this.$store.commit("userManage/SET_DIALOG",e)}}}},j=M,W=(r("8eb4"),Object(f["a"])(j,i,a,!1,null,"3a6995c0",null));t["default"]=W.exports}}]);